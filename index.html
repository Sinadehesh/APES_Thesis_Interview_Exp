from pathlib import Path

# Full HTML with image instead of emoji during condition 2
html_content = """
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Interview Demo with Preview & Surveys</title>
  <style>
    body { display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; font-family: 'Segoe UI', Tahoma, Verdana, sans-serif; background: linear-gradient(135deg, #ece9e6, #ffffff); }
    .container { width: 600px; max-width: 90vw; padding: 30px; background: #fff; border-radius: 12px; box-shadow: 0 4px 12px rgba(0,0,0,0.1); text-align: center; margin-bottom: 20px; }
    .hidden { display: none; }
    button { font-size: 1.1em; padding: 12px 24px; margin: 10px 5px; border: none; border-radius: 6px; cursor: pointer; transition: background 0.3s; }
    button:hover { background-color: #e6e6e6; }
    #startInterviewBtn { background: #1976d2; color: #fff; }
    #startRecordingBtn { background: red; color: #fff; }
    #redoBtn, #finishBtn, #previewRedoBtn, #previewNextBtn, #nextSurveyBtn { background: #1976d2; color: #fff; }
    .status-row { display: flex; justify-content: center; align-items: center; gap: 20px; margin: 15px 0; }
    .preview-video { margin-top: 20px; max-width: 100%; border-radius: 6px; box-shadow: 0 2px 8px rgba(0,0,0,0.1); }
    .question-block, .radio-group { text-align: left; margin: 10px 0; }
    .radio-group label { margin-right: 10px; }
  </style>
</head>
<body>
  <div id="startPage" class="container">
    <h1>Welcome to Your Dream Job Interview</h1>
    <p>Record answers in 3 conditions (mirror, image, blank).<br>6 questions total, ~20 minutes.<br>After every 2 questions, complete a short questionnaire.<br>Click Start to begin.</p>
    <button id="startInterviewBtn">Start Interview</button>
  </div>

  <div id="interviewContainer" class="container hidden">
    <p id="questionDisplay"></p>
    <div id="viewContainer"></div>
    <p id="startInstruction">Click <strong>Start Recording</strong> when ready. You have 30s.</p>
    <button id="startRecordingBtn">Start Recording</button>
    <div class="status-row">
      <span id="redoDisplay"></span>
      <div id="recordIndicator" style="width:20px;height:20px;background:red;border-radius:50%;visibility:hidden;"></div>
      <div id="timerDisplay" style="color:red;font-weight:bold;font-size:1.5em;visibility:hidden;">30</div>
    </div>
    <div style="display:flex;justify-content:space-between;">
      <button id="redoBtn" style="flex:1; margin-right:10px;">Redo</button>
      <button id="finishBtn" style="flex:1;">Finish</button>
    </div>
  </div>

  <div id="previewPage" class="container hidden">
    <h2>Your Recording Preview</h2>
    <video id="previewVideo" class="preview-video" controls></video>
    <div style="display:flex;justify-content:space-between;">
      <button id="previewRedoBtn" style="flex:1; margin-right:10px;">Redo</button>
      <button id="previewNextBtn" style="flex:1;">Next Question</button>
    </div>
  </div>

  <div id="endPage" class="container hidden">
    <h2>Thank You!</h2>
    <p>Thank you for taking part in the experiment. Science owes you one!</p>
  </div>

  <script>
    window.onload = () => {
      const questions = [
        "Tell me about yourself.",
        "What are your strengths?",
        "What are your weaknesses?",
        "Why do you want this job?",
        "Describe a time you overcame a challenge.",
        "Where do you see yourself in five years?"
      ];
      const conditions = [1, 1, 2, 2, 3, 3];

      let currentIndex = 0;
      let redoCounts = Array(questions.length).fill(0);
      let mediaRecorder, recordedChunks = [];
      let liveStream;

      const startPage = document.getElementById('startPage');
      const interviewPage = document.getElementById('interviewContainer');
      const previewPage = document.getElementById('previewPage');
      const endPage = document.getElementById('endPage');
      const viewContainer = document.getElementById('viewContainer');
      const questionDisplay = document.getElementById('questionDisplay');
      const startInstruction = document.getElementById('startInstruction');
      const startRecBtn = document.getElementById('startRecordingBtn');
      const recordIndicator = document.getElementById('recordIndicator');
      const timerDisplay = document.getElementById('timerDisplay');
      const redoDisplay = document.getElementById('redoDisplay');
      const redoBtn = document.getElementById('redoBtn');
      const finishBtn = document.getElementById('finishBtn');
      const previewVideo = document.getElementById('previewVideo');
      const previewRedoBtn = document.getElementById('previewRedoBtn');
      const previewNextBtn = document.getElementById('previewNextBtn');
      const startInterviewBtn = document.getElementById('startInterviewBtn');

      navigator.mediaDevices.getUserMedia({video:true,audio:true})
        .then(stream => liveStream = stream)
        .catch(err => console.error('Stream error:', err));

      startInterviewBtn.onclick = () => {
        startPage.classList.add('hidden');
        interviewPage.classList.remove('hidden');
        showQuestion();
      };

      function showQuestion() {
        previewPage.classList.add('hidden'); endPage.classList.add('hidden');
        interviewPage.classList.remove('hidden');
        viewContainer.innerHTML = '';
        questionDisplay.textContent = questions[currentIndex];
        redoDisplay.textContent = `Redo Count: ${redoCounts[currentIndex]}`;
        startInstruction.style.display = 'block';
        startRecBtn.style.display = 'inline-block';
        recordIndicator.style.visibility = 'hidden';
        timerDisplay.style.visibility = 'hidden';
        finishBtn.textContent = 'Finish';

        if (conditions[currentIndex] === 1 && liveStream) {
          const vid = document.createElement('video');
          vid.srcObject = liveStream;
          vid.autoplay = true;
          vid.muted = true;
          vid.playsInline = true;
          vid.style.width = '100%';
          viewContainer.appendChild(vid);
        } else if (conditions[currentIndex] === 2) {
          const img = document.createElement('img');
          img.src = 'input.jpg';
          img.alt = 'Condition Image';
          img.style.width = '200px';
          img.style.margin = '20px';
          viewContainer.appendChild(img);
        }
      }

      startRecBtn.onclick = () => {
        startInstruction.style.display = 'none';
        startRecBtn.style.display = 'none';
        recordedChunks = [];
        mediaRecorder = new MediaRecorder(liveStream);
        mediaRecorder.ondataavailable = e => { if (e.data.size) recordedChunks.push(e.data); };
        mediaRecorder.onstop = () => {
          const blob = new Blob(recordedChunks, { type: 'video/webm' });
          const url = URL.createObjectURL(blob);
          previewVideo.src = url;
          interviewPage.classList.add('hidden');
          previewPage.classList.remove('hidden');
        };
        mediaRecorder.start();
        startTimer();
        recordIndicator.style.visibility = 'visible';
      };

      redoBtn.onclick = () => {
        if (mediaRecorder && mediaRecorder.state === 'recording') mediaRecorder.stop();
        clearInterval(timerDisplay._interval);
        redoCounts[currentIndex]++;
        showQuestion();
      };

      finishBtn.onclick = () => {
        if (mediaRecorder && mediaRecorder.state === 'recording') mediaRecorder.stop();
      };

      previewRedoBtn.onclick = () => {
        previewPage.classList.add('hidden');
        showQuestion();
      };

      previewNextBtn.onclick = () => {
        previewVideo.pause();
        previewVideo.currentTime = 0;
        clearInterval(timerDisplay._interval);
        currentIndex++;
        if (currentIndex < questions.length) {
          showQuestion();
        } else {
          endPage.classList.remove('hidden');
        }
      };

      function startTimer() {
        let t = 30;
        timerDisplay.textContent = t;
        timerDisplay.style.visibility = 'visible';
        timerDisplay._interval = setInterval(() => {
          t--;
          timerDisplay.textContent = t;
          if (t <= 0) {
            clearInterval(timerDisplay._interval);
            mediaRecorder.stop();
          }
        }, 1000);
      }
    };
  </script>
</body>
</html>
"""

# Save the file
output_path = Path("/mnt/data/interview_with_image.html")
output_path.write_text(html_content)

output_path.name
